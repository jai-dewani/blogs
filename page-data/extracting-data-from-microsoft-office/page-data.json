{"componentChunkName":"component---src-templates-blog-post-js","path":"/extracting-data-from-microsoft-office/","result":{"data":{"site":{"siteMetadata":{"title":"Blogs by JaiD"}},"markdownRemark":{"id":"51cc2613-02ab-5de0-b370-c81ad7a53cd2","excerpt":"Around 2007, Microsoft switched from their proprietary binary format DOC, PPT, XLS, etc to an open format which stores data as a collection of XML files allâ€¦","html":"<p>Around 2007, Microsoft switched from their proprietary binary format DOC, PPT, XLS, etc to an open format which stores data as a collection of XML files all zipped together with everything from media to template information to how the text is to be formated. These new formats came with new extensions DOC<strong>X</strong>, PPT<strong>X</strong>, XLS<strong>X</strong>, etc where <strong>X</strong> stands for XML and allows this format to be more open and accessible, allowing this format to be parsed and understood by any other software that wishes to parse it and with this DOCX is the most used and popular standard. The same goes for other Microsoft formats.</p>\n<p>Since all Microsoft formats are ZIP files that contain everything in XML format, all blob elements like Images, Videos and Audio are stored as it is in the <code class=\"language-text\">/media</code> folder.</p>\n<p>Extensions are just a fancy codeword for your operating system to help him understand how to handle a file, to open it in MS Word or MS Powerpoint. The actual file type is determined by the Signature of files (magic number) which is a sequence of bytes present in the header which is unique for each file type <a href=\"https://en.wikipedia.org/wiki/List_of_file_signatures\">List of file signatures</a>.</p>\n<blockquote>\n<p><strong>Talk is cheap, Show me the code</strong> - Linus Torvalds</p>\n</blockquote>\n<div style=\"text-align:center\"><img src=\"/blogs/1078f286fae9c0c03c9a7c87a361f419/good-stuff.gif\"></div>\n<h2>See it for yourself</h2>\n<p>Open your Docx, Pptx, or any MS Office file in a text editor which should display it in hexadecimal format. Look up the first 4 bytes (8 characters) which should be <code class=\"language-text\">504b 0304</code> and lookup the <a href=\"https://filesignatures.net/index.php?page=search&#x26;search=ZIP&#x26;mode=EXT\">Signature of Zip files</a>. <strong>They both match!</strong> Hence internally both the files are the same, the only difference is caused by the OS assigning different software to open a file depending on the extension at the end of the filename.</p>\n<p><img src=\"./images/text-file.jpg\" alt=\"\"></p>\n<p>Enough analyzing, let's get inside this mess!</p>\n<h2>Let's Hack Microsoft Office files!</h2>\n<div style=\"text-align:center\"><img src=\"/blogs/39c7d4f3a2863cb1e53c117df339538a/hacking.gif\"></div>\n<p>Open any Zip Programs like 7-Zip or WinZip and select an MS Office file and choose <code class=\"language-text\">Extract to</code> and select the location where you want to unzip the file.\n<img src=\"images/unzip.jpg\" alt=\"\"></p>\n<h3>How Media is stored in MS Office files</h3>\n<p>What makes this new format open is that the images, videos, and anything media are stored as it is in the media folder as visible in the folder structure below.</p>\n<p>What makes this even better is that all the text and meta-information is stored in XML format which can be ready openly and parsed easily after understanding the format of XML which is universal for each MS Office file. <strong>Just copy and paste all the media and your work is done!</strong></p>\n<p><img src=\"images/folder.jpg\" alt=\"\"></p>\n<h2>Extra bits</h2>\n<p>There are a lot of files that use the same technique of hiding their data behind a zipped file with extensions to let the OS know how to handle the file in execution like</p>\n<ul>\n<li>aar, apk - Android application archive files, create when App Installer files are generated.</li>\n<li>epub - An ebook file format</li>\n<li>ipa - It is an iOS application archive file, used to distribute installable apps</li>\n<li>jar - An archive of Java class files and metadata into one package for easy distribution</li>\n<li>kmz - Used for expressing geographic annotation and visualization within two-dimensional maps and three-dimensional Earth browsers</li>\n<li>maff - Mozilla Archive format, used to store all the contents of a webpage in a ZIP file for ease of management</li>\n<li>odp, ods, odt - Used by office suites like OpenOffice and LibreOffice. Text documents (. odt), as well as spreadsheets (. ods) and also presentations (. odp).</li>\n</ul>\n<blockquote>\n<p><em>Like my content? Consider subscribing to my <a href=\"https://buttondown.email/jai_dewani\">Newsletter</a>. or support me by <a href=\"https://twitter.com/intent/tweet?text=Checkout%20%22Extracting%20Images,%20Audio,%20Videos%20from%20Microsoft%20Office%20files%22%20by%20%40jai_dewani%20%0A%0Ahttps%3A//blogs.jaid.tech/extracting-data-from-microsoft-office/%0A%0A%23microsoft%20%23office%20%23ZIP%20%23Data%20\">tweeting</a> about my blog</em></p>\n</blockquote>","frontmatter":{"title":"Extracting Images, Audio and Videos from Microsoft Office files","date":"December 15, 2020","description":"It was a shocker to me when I got to know Microsoft office files bascially are ZIP files under the hood. You also didn't? Try unzipping them and you will see the magic, also the fact that you can easily extract all media out of them once we know this"}},"previous":{"fields":{"slug":"/ctc-inflation/"},"frontmatter":{"title":"The truth behind 43 Lakh CTC? Why is CTC Inflation?"}},"next":{"fields":{"slug":"/automate-whatsapp/"},"frontmatter":{"title":"Create Your Own Whatsapp Spambot in 5 Minutes"}}},"pageContext":{"id":"51cc2613-02ab-5de0-b370-c81ad7a53cd2","previousPostId":"b35c20cf-0091-58d5-9bfe-c380e63bc375","nextPostId":"f3524ef4-6207-5d54-b468-b1fce28a3168"}},"staticQueryHashes":["2841359383","3257411868"],"slicesMap":{}}